/*	--------------------------------------------------------------------
	MaxImage 2.0 (Fullscreen Slideshow for use with jQuery Cycle Plugin)
	--------------------------------------------------------------------
	
	Examples and documentation at: http://www.aaronvanderzwan.com/maximage/2.0/
	Copyright (c) 2007-2012 Aaron Vanderzwan
	Dual licensed under the MIT and GPL licenses.		
*/
/*!	
 * Maximage Version: 2.0.8 (16-Jan-2012) - http://www.aaronvanderzwan.com/maximage/2.0/
 */
(function(a){a.fn.maximage=function(h,v){function k(a){window.console&&window.console.log&&window.console.log(a)}var f;if("object"==typeof h||void 0===h)f=a.extend(a.fn.maximage.defaults,h||{});"string"==typeof h&&(f=a.fn.maximage.defaults);a.Body=a("body");a.Window=a(window);a.Scroll=a("html, body");a.Events={RESIZE:"resize"};this.each(function(){var e=a(this),n=0,t=[],p={setup:function(){if(0<a.Slides.length){var b,c=a.Slides.length;for(b=0;b<c;b++){var d=a.Slides[b];e.append('<div class="mc-image '+
d.theclass+'" title="'+d.alt+'" style="background-image:url(\''+d.url+"');"+d.style+'" data-href="'+d.datahref+'">'+d.content+"</div>")}p.preload(0);p.resize()}},preload:function(b){var c=a("<img/>");c.load(function(){0==n&&(r.setup(),f.onFirstImageLoaded());if(n==a.Slides.length-1)f.onImagesLoaded(e);else n++,p.preload(n)});c[0].src=a.Slides[b].url;t.push(c[0])},resize:function(){a.Window.bind(a.Events.RESIZE,function(){a.Scroll.addClass("mc-hide-scrolls");a.Window.data("h",g.sizes().h).data("w",
g.sizes().w);e.height(a.Window.data("h")).width(a.Window.data("w")).children().height(a.Window.data("h")).width(a.Window.data("w"));e.children().each(function(){this.cycleH=a.Window.data("h");this.cycleW=a.Window.data("w")});a(a.Scroll).removeClass("mc-hide-scrolls")})}},l={setup:function(){var b,c,d=a.Slides.length;a.BrowserTests.msie&&!f.overrideMSIEStop&&document.execCommand("Stop",!1);e.html("");a.Body.addClass("mc-old-browser");if(0<a.Slides.length){a.Scroll.addClass("mc-hide-scrolls");a.Window.data("h",
g.sizes().h).data("w",g.sizes().w);a("body").append(a("<div></div>").attr("class","mc-loader").css({position:"absolute",left:"-9999px"}));for(c=0;c<d;c++)b=0==a.Slides[c].content.length?'<img src="'+a.Slides[c].url+'" />':a.Slides[c].content,b=a("<div>"+b+"</div>").attr("class","mc-image mc-image-n"+c+" "+a.Slides[c].theclass),e.append(b),0!=a(".mc-image-n"+c).children("img").length&&a("div.mc-loader").append(a(".mc-image-n"+c).children("img").first().clone().addClass("not-loaded"));l.preload();l.windowResize()}},
preload:function(){var b=setInterval(function(){a(".mc-loader").children("img").each(function(b){var d=a(this);d.hasClass("not-loaded")&&0<d.height()&&(a(this).removeClass("not-loaded"),a("div.mc-image-n"+b).children("img").first().data("h",d.height()).data("w",d.width()).data("ar",d.width()/d.height()),l.onceLoaded(b))});0==a(".not-loaded").length&&(a(".mc-loader").remove(),clearInterval(b))},1E3)},onceLoaded:function(b){l.maximage(b);0==b?(e.css({visibility:"visible"}),f.onFirstImageLoaded()):b==
a.Slides.length-1&&(r.setup(),a(a.Scroll).removeClass("mc-hide-scrolls"),f.onImagesLoaded(e),f.debug&&(k(" - Final Maximage - "),k(e)))},maximage:function(b){a("div.mc-image-n"+b).height(a.Window.data("h")).width(a.Window.data("w")).children("img").first().each(function(){m.maxcover(a(this))})},windowResize:function(){a.Window.bind(a.Events.RESIZE,function(){clearTimeout(this.id);1<=a(".mc-image").length&&(this.id=setTimeout(l.doneResizing,200))})},doneResizing:function(){a(a.Scroll).addClass("mc-hide-scrolls");
a.Window.data("h",g.sizes().h).data("w",g.sizes().w);e.height(a.Window.data("h")).width(a.Window.data("w"));e.find(".mc-image").each(function(a){l.maximage(a)});var b=e.data("cycle.opts");void 0!=b&&(b.height=a.Window.data("h"),b.width=a.Window.data("w"),jQuery.each(b.elements,function(b,d){d.cycleW=a.Window.data("w");d.cycleH=a.Window.data("h")}));a(a.Scroll).removeClass("mc-hide-scrolls")}},r={setup:function(){e.addClass("mc-cycle");a.Window.data("h",g.sizes().h).data("w",g.sizes().w);jQuery.easing.easeForCSSTransition=
function(a,b,e,f,g,k){return e+f};var b=a.extend({fit:1,containerResize:0,height:a.Window.data("h"),width:a.Window.data("w"),slideResize:!1,easing:a.BrowserTests.cssTransitions&&f.cssTransitions?"easeForCSSTransition":"swing"},f.cycleOptions);e.cycle(b)}},m={center:function(b){f.verticalCenter&&b.css({marginTop:(b.height()-a.Window.data("h"))/2*-1});f.horizontalCenter&&b.css({marginLeft:(b.width()-a.Window.data("w"))/2*-1})},fill:function(b){var c=b.is("object")?b.parent().first():b;"function"==typeof f.backgroundSize?
f.backgroundSize(b):"cover"==f.backgroundSize?a.Window.data("w")/a.Window.data("h")<c.data("ar")?b.height(a.Window.data("h")).width((a.Window.data("h")*c.data("ar")).toFixed(0)):b.height((a.Window.data("w")/c.data("ar")).toFixed(0)).width(a.Window.data("w")):"contain"==f.backgroundSize?a.Window.data("w")/a.Window.data("h")<c.data("ar")?b.height((a.Window.data("w")/c.data("ar")).toFixed(0)).width(a.Window.data("w")):b.height(a.Window.data("h")).width((a.Window.data("h")*c.data("ar")).toFixed(0)):k("The backgroundSize option was not recognized for older browsers.")},
maxcover:function(a){m.fill(a);m.center(a)},maxcontain:function(a){m.fill(a);m.center(a)}},g={browser_tests:function(){var b=a("<div />")[0],c=["Moz","Webkit","Khtml","O","ms"],d="transition",e={cssTransitions:!1,cssBackgroundSize:"backgroundSize"in b.style&&f.cssBackgroundSize,html5Video:!1,msie:!1};if(f.cssTransitions){"string"==typeof b.style[d]&&(e.cssTransitions=!0);for(var d=d.charAt(0).toUpperCase()+d.substr(1),h=0;h<c.length;h++)c[h]+d in b.style&&(e.cssTransitions=!0)}document.createElement("video").canPlayType&&
(e.html5Video=!0);e.msie=void 0!==g.msie();f.debug&&(k(" - Browser Test - "),k(e));return e},construct_slide_object:function(){var b={},c=[];e.children().each(function(d){d=a(this).is("img")?a(this).clone():a(this).find("img").first().clone();b={};b.url=d.attr("src");b.title=void 0!=d.attr("title")?d.attr("title"):"";b.alt=void 0!=d.attr("alt")?d.attr("alt"):"";b.theclass=void 0!=d.attr("class")?d.attr("class"):"";b.styles=void 0!=d.attr("style")?d.attr("style"):"";b.orig=d.clone();b.datahref=void 0!=
d.attr("data-href")?d.attr("data-href"):"";b.content="";0<a(this).find("img").length&&(a.BrowserTests.cssBackgroundSize&&a(this).find("img").first().remove(),b.content=a(this).html());d[0].src="";a.BrowserTests.cssBackgroundSize&&a(this).remove();c.push(b)});f.debug&&(k(" - Slide Object - "),k(c));return c},msie:function(){for(var a=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",d[0];);return 4<a?a:void 0},sizes:function(){var b=
{h:0,w:0};if("window"==f.fillElement)b.h=a.Window.height(),b.w=a.Window.width();else{var c=e.parents(f.fillElement).first();0==c.height()||1==c.data("windowHeight")?(c.data("windowHeight",!0),b.h=a.Window.height()):b.h=c.height();0==c.width()||1==c.data("windowWidth")?(c.data("windowWidth",!0),b.w=a.Window.width()):b.w=c.width()}return b}};a.BrowserTests=g.browser_tests();if("string"==typeof h){if(a.BrowserTests.html5Video||!e.is("video")){var q,u=e.is("object")?e.parent().first():e;a.Body.hasClass("mc-old-browser")||
a.Body.addClass("mc-old-browser");a.Window.data("h",g.sizes().h).data("w",g.sizes().w);u.data("h",e.height()).data("w",e.width()).data("ar",e.width()/e.height());a.Window.bind(a.Events.RESIZE,function(){a.Window.data("h",g.sizes().h).data("w",g.sizes().w);q=e.data("resizer");clearTimeout(q);q=setTimeout(m[h](e),200);e.data("resizer",q)});m[h](e)}}else a.Slides=g.construct_slide_object(),a.BrowserTests.cssBackgroundSize?(f.debug&&k(" - Using Modern - "),p.setup()):(f.debug&&k(" - Using Old - "),l.setup())})};
a.fn.maximage.defaults={debug:!1,cssBackgroundSize:!0,cssTransitions:!0,verticalCenter:!0,horizontalCenter:!0,scaleInterval:20,backgroundSize:"cover",fillElement:"window",overrideMSIEStop:!1,onFirstImageLoaded:function(){},onImagesLoaded:function(){}}})(jQuery);